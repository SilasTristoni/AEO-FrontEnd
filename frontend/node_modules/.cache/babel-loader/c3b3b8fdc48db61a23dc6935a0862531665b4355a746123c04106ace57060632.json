{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\joao.garcia2\\\\Documents\\\\testeFront\\\\AEO-FrontEnd\\\\frontend\\\\src\\\\context\\\\AuthContext.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useState, useEffect, useCallback } from 'react';\nimport { jwtDecode } from 'jwt-decode'; // Você já instalou, mas confirme\nimport api from '../api/api';\n\n// Criação do Contexto\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext(null);\n\n// Provedor do Contexto\nexport const AuthProvider = ({\n  children\n}) => {\n  _s();\n  const [auth, setAuth] = useState({\n    token: null,\n    user: null,\n    isAuthenticated: false\n  });\n  const [loading, setLoading] = useState(true);\n\n  // Função de login: recebe o token, salva, e atualiza o estado\n  const login = useCallback(token => {\n    try {\n      localStorage.setItem('token', token);\n      api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      const decoded = jwtDecode(token);\n      setAuth({\n        token: token,\n        user: {\n          id: decoded.id,\n          name: decoded.name\n        },\n        isAuthenticated: true\n      });\n    } catch (error) {\n      console.error(\"Erro ao decodificar o token\", error);\n      logout();\n    }\n  }, []);\n  const logout = () => {\n    localStorage.removeItem('token');\n    delete api.defaults.headers.common['Authorization'];\n    setAuth({\n      token: null,\n      user: null,\n      isAuthenticated: false\n    });\n  };\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      login(token);\n    }\n    setLoading(false);\n  }, [login]);\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Carregando Aplica\\xE7\\xE3o...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      ...auth,\n      login,\n      logout\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 49,\n    columnNumber: 5\n  }, this);\n};\n_s(AuthProvider, \"DT4n2KegSjRGhWYOT6uQN/xy8iQ=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","useCallback","jwtDecode","api","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","_s","auth","setAuth","token","user","isAuthenticated","loading","setLoading","login","localStorage","setItem","defaults","headers","common","decoded","id","name","error","console","logout","removeItem","getItem","fileName","_jsxFileName","lineNumber","columnNumber","Provider","value","_c","$RefreshReg$"],"sources":["C:/Users/joao.garcia2/Documents/testeFront/AEO-FrontEnd/frontend/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect, useCallback } from 'react';\r\nimport { jwtDecode } from 'jwt-decode'; // Você já instalou, mas confirme\r\nimport api from '../api/api';\r\n\r\n// Criação do Contexto\r\nexport const AuthContext = createContext(null);\r\n\r\n// Provedor do Contexto\r\nexport const AuthProvider = ({ children }) => {\r\n  const [auth, setAuth] = useState({ token: null, user: null, isAuthenticated: false });\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Função de login: recebe o token, salva, e atualiza o estado\r\n  const login = useCallback((token) => {\r\n    try {\r\n      localStorage.setItem('token', token);\r\n      api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n      const decoded = jwtDecode(token);\r\n      setAuth({\r\n        token: token,\r\n        user: { id: decoded.id, name: decoded.name },\r\n        isAuthenticated: true,\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Erro ao decodificar o token\", error);\r\n      logout();\r\n    }\r\n  }, []);\r\n\r\n  const logout = () => {\r\n    localStorage.removeItem('token');\r\n    delete api.defaults.headers.common['Authorization'];\r\n    setAuth({ token: null, user: null, isAuthenticated: false });\r\n  };\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('token');\r\n    if (token) {\r\n      login(token);\r\n    }\r\n    setLoading(false);\r\n  }, [login]);\r\n\r\n  if (loading) {\r\n    return <div>Carregando Aplicação...</div>;\r\n  }\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ ...auth, login, logout }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,aAAa,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO;AAC9E,SAASC,SAAS,QAAQ,YAAY,CAAC,CAAC;AACxC,OAAOC,GAAG,MAAM,YAAY;;AAE5B;AAAA,SAAAC,MAAA,IAAAC,OAAA;AACA,OAAO,MAAMC,WAAW,gBAAGR,aAAa,CAAC,IAAI,CAAC;;AAE9C;AACA,OAAO,MAAMS,YAAY,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,EAAA;EAC5C,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGZ,QAAQ,CAAC;IAAEa,KAAK,EAAE,IAAI;IAAEC,IAAI,EAAE,IAAI;IAAEC,eAAe,EAAE;EAAM,CAAC,CAAC;EACrF,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGjB,QAAQ,CAAC,IAAI,CAAC;;EAE5C;EACA,MAAMkB,KAAK,GAAGhB,WAAW,CAAEW,KAAK,IAAK;IACnC,IAAI;MACFM,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEP,KAAK,CAAC;MACpCT,GAAG,CAACiB,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,UAAUV,KAAK,EAAE;MAChE,MAAMW,OAAO,GAAGrB,SAAS,CAACU,KAAK,CAAC;MAChCD,OAAO,CAAC;QACNC,KAAK,EAAEA,KAAK;QACZC,IAAI,EAAE;UAAEW,EAAE,EAAED,OAAO,CAACC,EAAE;UAAEC,IAAI,EAAEF,OAAO,CAACE;QAAK,CAAC;QAC5CX,eAAe,EAAE;MACnB,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOY,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;MACnDE,MAAM,CAAC,CAAC;IACV;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMA,MAAM,GAAGA,CAAA,KAAM;IACnBV,YAAY,CAACW,UAAU,CAAC,OAAO,CAAC;IAChC,OAAO1B,GAAG,CAACiB,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC;IACnDX,OAAO,CAAC;MAAEC,KAAK,EAAE,IAAI;MAAEC,IAAI,EAAE,IAAI;MAAEC,eAAe,EAAE;IAAM,CAAC,CAAC;EAC9D,CAAC;EAEDd,SAAS,CAAC,MAAM;IACd,MAAMY,KAAK,GAAGM,YAAY,CAACY,OAAO,CAAC,OAAO,CAAC;IAC3C,IAAIlB,KAAK,EAAE;MACTK,KAAK,CAACL,KAAK,CAAC;IACd;IACAI,UAAU,CAAC,KAAK,CAAC;EACnB,CAAC,EAAE,CAACC,KAAK,CAAC,CAAC;EAEX,IAAIF,OAAO,EAAE;IACX,oBAAOV,OAAA;MAAAG,QAAA,EAAK;IAAuB;MAAAuB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC;EAC3C;EAEA,oBACE7B,OAAA,CAACC,WAAW,CAAC6B,QAAQ;IAACC,KAAK,EAAE;MAAE,GAAG1B,IAAI;MAAEO,KAAK;MAAEW;IAAO,CAAE;IAAApB,QAAA,EACrDA;EAAQ;IAAAuB,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACW,CAAC;AAE3B,CAAC;AAACzB,EAAA,CA5CWF,YAAY;AAAA8B,EAAA,GAAZ9B,YAAY;AAAA,IAAA8B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}